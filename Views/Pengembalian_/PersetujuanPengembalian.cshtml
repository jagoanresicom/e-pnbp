@model Pnbp.Entities.FindPengembalianPnbp

@{
    var tipekantorid = ViewData["tipekantorid"].ToString();
}

<div class="" id="dynamic_content">
    <div class="page-title">
        <div class="title_left"><h2 style="width:100%">Persetujuan Pengembalian PNBP</h2></div>
        <div class="clearfix"></div>
    </div>
    <div class="clearfix"></div>

    <div class="row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="x_panel" style="padding-top:10px; border:1px solid #E6E9ED;">
                <div class="x_title">
                    <h2>Pencarian Data</h2>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <form class="form-horizontal form-label-left" id="frmCariPengajuan" method="post">

                        <div class="row">
                            <div class="col-md-6 col-xs-12">
                                <div class="form-group" id="DivSearch_Wilayah">
                                    <label class="control-label col-md-3 col-sm-3 col-xs-12">Nama Kantor : </label>
                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                        @Html.TextBoxFor(model => model.CariNamaKantor, new { @class = "form-control" })
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-3 col-sm-3 col-xs-12">Keterangan : </label>
                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                        @Html.TextBoxFor(model => model.CariJudul, new { @class = "form-control" })
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-3 col-sm-3 col-xs-12">Nomor Berkas : </label>
                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                        @Html.TextBoxFor(model => model.CariNomorBerkas, new { @class = "form-control" })
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-3 col-sm-3 col-xs-12">Kode Billing : </label>
                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                        @Html.TextBoxFor(model => model.CariKodeBilling, new { @class = "form-control" })
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-3 col-sm-3 col-xs-12">NTPN : </label>
                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                        @Html.TextBoxFor(model => model.CariNTPN, new { @class = "form-control" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 col-xs-12">
                                <div class="form-group">
                                    <label class="control-label col-md-4 col-sm-4 col-xs-12">Nama Pemohon : </label>
                                    <div class="col-md-8 col-sm-8 col-xs-12">
                                        @Html.TextBoxFor(model => model.CariNamaPemohon, new { @class = "form-control" })
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-4 col-sm-4 col-xs-12">NIK Pemohon : </label>
                                    <div class="col-md-8 col-sm-8 col-xs-12">
                                        @Html.TextBoxFor(model => model.CariNikPemohon, new { @class = "form-control" })
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-4 col-sm-4 col-xs-12">Alamat Pemohon : </label>
                                    <div class="col-md-8 col-sm-8 col-xs-12">
                                        @Html.TextBoxFor(model => model.CariAlamatPemohon, new { @class = "form-control" })
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-4 col-sm-4 col-xs-12">Nomor Telepon : </label>
                                    <div class="col-md-8 col-sm-8 col-xs-12">
                                        @Html.TextBoxFor(model => model.CariTeleponPemohon, new { @class = "form-control" })
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-4 col-sm-4 col-xs-12">Bank Persepsi : </label>
                                    <div class="col-md-8 col-sm-8 col-xs-12">
                                        @Html.TextBoxFor(model => model.CariBankPersepsi, new { @class = "form-control" })
                                    </div>
                                </div>
                                @*<div class="form-group">
                        <label class="control-label col-md-4 col-sm-4 col-xs-12">Status ?</label>
                        <div class="col-md-3 col-sm-12 col-xs-12">
                            <span class="input-group checkbox">
                                @Html.CheckBoxFor(model => model.IsDisetujui, new { @class = "js-switch", @id = "statusdisetujui" })
                                @Html.LabelFor(model => model.IsDisetujui, new { @id = "LabelIsDisetujui", @style = "text-align:left; padding-left:3px;" })
                            </span>
                        </div>
                    </div>*@
                            </div>
                        </div>
                    </form>
                    <div class="">
                        <div class="col-md-12 col-sm-12 col-xs-12 col-md-offset-0">
                            <button id="btnCari" type="submit" form="frmCariPengajuan" class="btn btn-success">Cari</button>
                            <button id="btnReset" type="reset" form="frmCariPengajuan" class="btn btn-warning">Reset</button>
                            @using (Html.BeginForm("ExportDataPengajuanPengembalian", "Pengembalian",
                            //    new
                            //{
                            //    CariNamaProvinsi = "JAWA BARAT",
                            //    CariTahun = "2017"
                            //}
                            FormMethod.Post, new { @class = "" }))
                            {
                                <button id="btnExportExcel" type="submit" class="btn btn-primary"><span class="fa fa-floppy-o"></span> Export ke Excel</button>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <table id="myTablePengembalianPnbp" class="table table-striped table-bordered" style="width:100%; background-color:white;">
        <thead>
            <tr>
                <th style="text-align:center;">No.</th>
                <th style="text-align:center;">Tanggal Pengajuan</th>
                <th id="Th_Wilayah">Nama Kantor</th>
                <th>Nomor Berkas</th>
                <th>Nama Pelayanan</th>
                <th>Kode Billing</th>
                <th>Jumlah Bayar</th>
                <th style="text-align:center;">Disetujui ?</th>
                <th style="text-align:center;">Tanggal Persetujuan</th>
                <th style="width:5%">Proses</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<a id="back-to-top" href="#" class="btn btn-primary back-to-top" role="button" title="" data-toggle="tooltip" data-placement="left"><span class="glyphicon glyphicon-chevron-up"></span></a>

<script type="text/javascript">

    $(document).ready(function () {

        if (@tipekantorid != "1") {
            $('#DivSearch_Wilayah').addClass('hidden');
            $('#Th_Wilayah').addClass('hidden');
        }

        createPagingPengajuan();

        $(window).scroll(function () {
            if ($(this).scrollTop() > 50) {
                $('#back-to-top').fadeIn();
            } else {
                $('#back-to-top').fadeOut();
            }
        });
        // scroll body to 0px on click
        $('#back-to-top').click(function () {
            $('#back-to-top').tooltip('hide');
            $('body,html').animate({
                scrollTop: 0
            }, 800);
            return false;
        });

        $('#back-to-top').tooltip('show');
    });

    $("#frmCariPengajuan").submit(function (e) {
        dtablePengajuan.ajax.reload(null, true);
        e.preventDefault();
        return false;
    });

    var dtablePengajuan;
    var createPagingPengajuan = function () {
        dtablePengajuan = $('#myTablePengembalianPnbp').DataTable({
            "bLengthChange": false,
            "paging": true,
            "pageLength": 10,
            "bFilter": false,
            "ordering": false,
            "info": false,
            "processing": true,
            "serverSide": true,
            "scrollX": false,
            "ajax": {
                url: '@Url.Action("DaftarPengajuanPengembalian", "Pengembalian")',
                type: "POST",
                data: function (data, obj) { var ftp = $('#frmCariPengajuan').serializeArray(); data.form = ftp; ftp.push({ name: "start", value: data.start }, { name: "length", value: data.length }); return ftp; }
            },
            "columns": [
                { "data": "RNumber", "className": "centertaligncolumn", "width": "5%" },
                { "data": "TanggalPengaju", "className": "centertaligncolumn", "width": "150px" },
                { "data": "NamaKantor" },
                { "data": "NomorBerkas" },
                { "data": "NamaProsedur" },
                { "data": "KodeBilling" },
                { "data": "JumlahBayarNumber", "className": "rightaligncolumn", render: formatangka },
                {
                    "data": "StatusSetuju",
                    "className": "centertaligncolumn",
                    "width": "10%",
                    render: function (data) {
                        if (data == '0') {
                            return '<b class="fa fa-close" style="color:#ce3535;"></b>';
                        }
                        else {
                            return '<b class="fa fa-check" style="color:#249c2f;"></b>';
                        }
                    }
                },
                { "data": "TanggalSetuju", "className": "centertaligncolumn", "width": "150px" },
                {
                    "data": "Proses",
                    "className": "centertaligncolumn",
                    "width": "5%",
                    render: function (data, type, row) {
                        return '<i class="fa fa-edit" style="cursor: pointer;"></i>';
                    }
                }
            ],
            rowCallback: function (row, data) {
                if (@tipekantorid != "1") {
                    // base in zero
                    $('td', row).eq(2).hide();
                }
            }
        });
    };

    $('#myTablePengembalianPnbp tbody').delegate('tr i', 'click', function (e) {
        var data = dtablePengajuan.row($(this).closest('tr')).data();

        window.location.href = '@Url.Action("ProsesPersetujuan", "Pengembalian")?pengembalianpnbpid=' + data.PengembalianPnbpId;

        e.preventDefault();
        return false;
    });

</script>