
@model Pnbp.Entities.CariPenerimaan
@{
    ViewBag.Title = "PengajuanPengembalianIndex";
    var tipekantorid = ViewData["tipekantorid"].ToString();
    var datasatker = ViewBag.datasatker;
}

<div class="" id="dynamic_content">

    <div class="clearfix"></div>

    <div class="row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="x_panel" style="padding-top:10px; border:1px solid #E6E9ED;">
                <div class="x_title">
                    <h2>Monitoring Evaluasi Penerimaan</h2>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <form class="form-horizontal form-label-left" id="frmCariPengajuan" method="post">

                        <div class="row">
                            <div class="col-md-6 col-xs-12">


                                @*@if (@OtorisasiUser.GetJenisKantorUser() == "Pusat")
                                    {
                                        <div class="form-group">
                                            <label class="control-label col-md-4 col-sm-4 col-xs-12">Satker : </label>
                                            <div class="col-md-8 col-sm-8 col-xs-12">
                                                @Html.TextBoxFor(model => model.CariNamaSatker, new { @class = "form-control" })
                                                <select name="KODESATKER" id="CariKodeSatker" class="form-control">
                                                    <option value=""></option>
                                                    @foreach (var row in datasatker)
                                                    {
                                                        <option value="@row.KodeSatker">@row.Nama_Satker</option>
                                                    }
                                                </select>
                                            </div>
                                        </div>
                                    }*@
                                <div class="row">
                                    <div class="col-md-12 col-xs-8">
                                        <div class="form-group">
                                            <label class="control-label col-md-2 col-sm-4 col-xs-12 text-left">Min : </label>
                                            <div class="col-md-3 col-sm-8 col-xs-12">
                                                @*<input type="text" name="PGMINPAGU" id="PGMINPAGU" class="form-control col-sm-2 PGMINPAGU" placeholder="" onkeypress="return number(event)" size="4" style="margin-left: 10px" />*@
                                                <input type="text" name="PGMINPAGU" id="PGMINPAGU" class="form-control col-sm-2 PGMINPAGU" placeholder="" size="4" style="margin-left: 10px" />
                                                @*<input type="hidden" name="PGMINPAGU" id="PGMINPAGU" class="form-control col-sm-2" placeholder="" size="4" style="margin-left: 10px" />*@
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="control-label col-md-2 col-sm-4 col-xs-12 text-left">Max : </label>
                                            <div class="col-md-3 col-sm-8 col-xs-12">
                                                @*<input type="text" name="PGMINPAGU" id="PGMINPAGU" class="form-control col-sm-2 PGMINPAGU" placeholder="" onkeypress="return number(event)" size="4" style="margin-left: 10px" />*@
                                                <input type="text" name="PGMAXPAGU" id="PGMAXPAGU" class="form-control col-sm-2 PGMAXPAGU" placeholder="" size="4" style="margin-left: 10px" />
                                                @*<input type="hidden" name="PGMINPAGU" id="PGMINPAGU" class="form-control col-sm-2" placeholder="" size="4" style="margin-left: 10px" />*@
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        @*<div class="ln_solid"></div>*@
                        @*<div class="form-group">
                                <div class="col-md-12 col-sm-12 col-xs-12 col-md-offset-0">
                                    <button id="btnCari" type="submit" class="btn btn-success">Cari</button>
                                    <button id="btnReset" type="reset" class="btn btn-warning">Reset</button>
                                    <button id="btnCreate" type="button" class="btn btn-primary">Buat Baru</button>
                                </div>
                            </div>*@
                    </form>
                    <div class="">
                        <div class="col-md-12 col-sm-12 col-xs-12 col-md-offset-0">
                            <button id="btnCari" type="submit" form="frmCariPengajuan" class="btn btn-primary" style="margin-left:25px;width:80px">&nbsp;Cari&nbsp;</button>
                            @*<button id="btnCreate" type="button" class="btn btn-primary">Buat Baru</button>*@
                            @*@using (Html.BeginForm("ExportDataPengajuanPengembalian", "Pengembalian",
                                //    new
                                //{
                                //    CariNamaProvinsi = "JAWA BARAT",
                                //    CariTahun = "2017"
                                //}
                                FormMethod.Post, new { @class = "" }))
                                                {
                                                    <button id="btnExportExcel" type="submit" class="btn btn-primary"><span class="fa fa-floppy-o"></span> Export ke Excel</button>
                                                }*@
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="page-title">
        <div class="title_left"><h2 style="width:100%">Daftar Monitoring Evaluasi Penerimaan</h2></div>
        <div class="clearfix"></div>
    </div>

    <table id="rincianAlokasi" class="table table-striped table-bordered" style="width:100%; background-color:white;">
        <thead>
            <tr>
                @if (@OtorisasiUser.GetJenisKantorUser() == "Pusat")
                {
                    <th style="text-align:center;">No.</th>
                }

                <th style="text-align:center;">Kode Satker</th>
                <th style="text-align:center;">Nama Satker</th>
                <th style="text-align:center;">Target</th>
                <th style="text-align:center;">Penerimaan</th>
                <th style="text-align:center;">Persentase</th>

                @if (@OtorisasiUser.GetJenisKantorUser() != "Pusat")
                {
                    <th style="text-align:center;">Evaluasi</th>
                }

                @if (@OtorisasiUser.GetJenisKantorUser() == "Pusat")
                {
                    <th style="text-align:center;">Renaksi</th>
                }

                @if (@OtorisasiUser.GetJenisKantorUser() == "Pusat")
                {
                    <th style="text-align:center;">Aksi Evaluasi</th>
                }
                else
                {
                    <th style="text-align:center;">Aksi Renaksi</th>
                }
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <!-- Modal Aksi Evaluasi -->
    <div class="modal fade" id="addEvaluasi" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <input type="hidden" name="kantorid" id="kantorid" />
                <input type="hidden" name="kodesatker" id="kodesatker" />
                <div class="modal-header">
                    <h3 class="modal-title" id="exampleModalLabel">Evaluasi</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top:-28px">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group row">
                            <div class="col-md-12 col-sm-12 ">
                                <div class="row">
                                    <label class="col-sm-3">Kode Satker</label>
                                    <label>:</label>
                                    <label><p id="textKodeSatker"></p></label>
                                </div>
                                <div class="row">
                                    <label class="col-sm-3">Nama Satker</label>
                                    <label>:</label>
                                    <label><p id="textNamaSatker"></p></label>
                                </div>
                                <textarea class="form-control" id="evaluasitext" rows="3" placeholder="Masukkan Evaluasi" onkeyup="validatetext()" oninput="auto_grow(this)"></textarea>
                                <span id="validate" class="text-danger" style="display: none;">* Data tidak boleh kosong</span>
                            </div>
                        </div>
                        <hr />
                        <h5 class="modal-title" id="exampleModalLabel">Data History Evaluasi</h5>
                        <table id="historiEvaluasi" class="table table-striped table-bordered" style="width:100%; background-color:white; margin-top:10px;">
                            <thead>
                                <tr>
                                    <th style="text-align:center;">No</th>
                                    <th style="text-align:center;">Evaluasi</th>
                                    @*<th style="text-align:center;">Create Date</th>*@
                                </tr>
                            </thead>
                            <tbody id="listHistory"></tbody>
                        </table>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" id="btnSimpan" onclick="saveEvaluasi()" class="btn btn-success">Simpan</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Kembali</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal Aksi Evaluasi -->
    <!-- Modal Aksi Renaksi -->
    <div class="modal fade" id="addRenaksi" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <input type="hidden" name="kantorid" id="kantorid" />
                <input type="hidden" name="kodesatker" id="kodesatker" />
                <div class="modal-header">
                    <h3 class="modal-title" id="exampleModalLabel">Rencana Aksi</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top:-28px">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group row">
                            <div class="col-md-12 col-sm-12 ">
                                <div class="row">
                                    <label class="col-sm-3">Kode Satker</label>
                                    <label>:</label>
                                    <label><p id="textKodeSatkerRenaksi"></p></label>
                                </div>

                                <div class="row">
                                    <label class="col-sm-3">Nama Satker</label>
                                    <label>:</label>
                                    <label><p id="textNamaSatkerRenaksi"></p></label>
                                </div>
                                <textarea class="form-control" id="renaksitext" rows="3" placeholder="Masukkan Rencana Aksi" onkeyup="validatetext()" oninput="auto_grow(this)"></textarea>
                                <span id="validaterenaksi" class="text-danger" style="display: none;">* Data tidak boleh kosong</span>
                            </div>
                        </div>
                        <hr />
                        <h5 class="modal-title" id="exampleModalLabel">Data History Rencana Aksi</h5>
                        <table id="historiRenaksi" class="table table-striped table-bordered" style="width:100%; background-color:white; margin-top:10px;">
                            <thead>
                                <tr>
                                    <th style="text-align:center;">No</th>
                                    <th style="text-align:center;">Renaksi</th>
                                    @*<th style="text-align:center;">Create Date</th>*@
                                </tr>
                            </thead>
                            <tbody id="listHistoryRenaksi"></tbody>
                        </table>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" id="btnSimpan" onclick="saveRenaksi()" class="btn btn-success">Simpan</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Kembali</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal Aksi Renaksi -->
    <!-- Modal Detail Evaluasi Modal -->
    <div class="modal fade" id="detailmodal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <input type="hidden" name="kantorid" id="kantorids" />
                <input type="hidden" name="kodesatker" id="kodesatker" />
                <div class="modal-header">
                    <h3 class="modal-title" id="exampleModalLabel">Detail Evaluasi</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top:-28px">
                        <span aria-hidden="true">&times;</span>
                    </button>

                    <div class="row" style="margin-top:8px">
                        <div class="col-sm-12">
                            <label class="col-sm-3">Kode Satker</label>
                            <label>:</label>
                            <label><p id="textDetailEvaluasiKode"></p></label>
                        </div>

                    </div>

                    <div class="row">
                        <div class="col-sm-12">
                            <label class="col-sm-3">Nama Satker</label>
                            <label>:</label>
                            <label><p id="textDetailEvaluasiNama"></p></label>
                        </div>
                    </div>
                </div>
                <div class="modal-body">
                    <form>

                        <p name="textmodal" id="textmodal"></p>
                    </form>
                </div>
                <div class="modal-footer">
                    @*<button type="button" id="btnSimpan" onclick="saveRenaksi()" class="btn btn-success" data-dismiss="modal">Simpan</button>*@
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Kembali</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal Detail Evaluasi Modal -->
    <!-- Modal Detail Renaksi Modal -->
    <div class="modal fade" id="detailmodalRenaksi" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <input type="hidden" name="kantorid" id="kantorids" />
                <input type="hidden" name="kodesatker" id="kodesatker" />
                <div class="modal-header">
                    <h3 class="modal-title" id="exampleModalLabel">Detail Rencana Aksi</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top:-28px">
                        <span aria-hidden="true">&times;</span>
                    </button>

                    <div class="row" style="margin-top:8px">
                        <div class="col-sm-12">
                            <label class="col-sm-3">Kode Satker</label>
                            <label>:</label>
                            <label><p id="textDetailRenaksiKode"></p></label>
                        </div>

                    </div>

                    <div class="row">
                        <div class="col-sm-12">
                            <label class="col-sm-3">Nama Satker</label>
                            <label>:</label>
                            <label><p id="textDetailRenaksiNama"></p></label>
                        </div>
                    </div>
                </div>
                <div class="modal-body">
                    <h5 class="modal-title" id="exampleModalLabel">Data History Rencana Aksi</h5>
                    <table id="historiEvaluasi" class="table table-striped table-bordered" style="width:100%; background-color:white; margin-top:10px;">
                        <thead>
                            <tr>
                                <th style="text-align:center;">No</th>
                                <th style="text-align:center;">Renaksi</th>
                                @*<th style="text-align:center;">Create Date</th>*@
                            </tr>
                        </thead>
                        <tbody id="listHistoryRenaksidetail"></tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    @*<button type="button" id="btnSimpan" onclick="saveRenaksi()" class="btn btn-success" data-dismiss="modal">Simpan</button>*@
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Kembali</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal Detail Renaksi Modal -->
    <!-- Modal Detail Renaksi pusat Modal -->
    <div class="modal fade" id="detailmodalRenaksipusat" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <input type="hidden" name="kantorid" id="kantorids" />
                <input type="hidden" name="kodesatker" id="kodesatker" />
                <div class="modal-header">
                    <h3 class="modal-title" id="exampleModalLabel">Detail Rencana Aksi</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top:-28px">
                        <span aria-hidden="true">&times;</span>
                    </button>

                    <div class="row" style="margin-top:8px">
                        <div class="col-sm-12">
                            <label class="col-sm-3">Kode Satker</label>
                            <label>:</label>
                            <label><p id="textDetailRenaksiKode"></p></label>
                        </div>

                    </div>

                    <div class="row">
                        <div class="col-sm-12">
                            <label class="col-sm-3">Nama Satker</label>
                            <label>:</label>
                            <label><p id="textDetailRenaksiNama"></p></label>
                        </div>
                    </div>
                </div>
                <div class="modal-body">
                    <h5 class="modal-title" id="exampleModalLabel">Data History Rencana Aksi</h5>
                    <table id="historiEvaluasi" class="table table-striped table-bordered" style="width:100%; background-color:white; margin-top:10px;">
                        <thead>
                            <tr>
                                <th style="text-align:center;">No</th>
                                <th style="text-align:center;">Renaksi</th>
                                @*<th style="text-align:center;">Create Date</th>*@
                            </tr>
                        </thead>
                        <tbody id="listHistoryRenaksidetailpusat"></tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    @*<button type="button" id="btnSimpan" onclick="saveRenaksi()" class="btn btn-success" data-dismiss="modal">Simpan</button>*@
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Kembali</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal Detail Renaksi Modal Pusat -->
    <!-- Modal Detail Evaluasi Modal -->
    <div class="modal fade" id="detailmodalEvaluasi" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <input type="hidden" name="kantorid" id="kantorids" />
                <input type="hidden" name="kodesatker" id="kodesatker" />
                <div class="modal-header">
                    <h3 class="modal-title" id="exampleModalLabel">Detail Evaluasi</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top:-28px">
                        <span aria-hidden="true">&times;</span>
                    </button>

                    <div class="row" style="margin-top:8px">
                        <div class="col-sm-12">
                            <label class="col-sm-3">Kode Satker</label>
                            <label>:</label>
                            <label><p id="textKodeSatkerDaerah"></p></label>
                        </div>

                    </div>

                    <div class="row">
                        <div class="col-sm-12">
                            <label class="col-sm-3">Nama Satker</label>
                            <label>:</label>
                            <label><p id="textNamaSatkerDaerah"></p></label>
                        </div>
                    </div>
                </div>
                <div class="modal-body">
                    <h5 class="modal-title" id="exampleModalLabel">Data History Evaluasi</h5>
                    <table id="historiEvaluasi" class="table table-striped table-bordered" style="width:100%; background-color:white; margin-top:10px;">
                        <thead>
                            <tr>
                                <th style="text-align:center;">No</th>
                                <th style="text-align:center;">Evaluasi</th>
                                @*<th style="text-align:center;">Create Date</th>*@
                            </tr>
                        </thead>
                        <tbody id="listHistoryEvaluasidetail"></tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    @*<button type="button" id="btnSimpan" onclick="saveRenaksi()" class="btn btn-success" data-dismiss="modal">Simpan</button>*@
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Kembali</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal Detail Evaluasi Modal -->
    <!-- Modal Detail Evaluasi Pusat Modal -->
    <div class="modal fade" id="detailmodalEvaluasi" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <input type="hidden" name="kantorid" id="kantorids" />
                <input type="hidden" name="kodesatker" id="kodesatker" />
                <div class="modal-header">
                    <h3 class="modal-title" id="exampleModalLabel">Detail Evaluasi</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top:-28px">
                        <span aria-hidden="true">&times;</span>
                    </button>

                    <div class="row" style="margin-top:8px">
                        <div class="col-sm-12">
                            <label class="col-sm-3">Kode Satker</label>
                            <label>:</label>
                            <label><p id="textKodeSatkerDaerah"></p></label>
                        </div>

                    </div>

                    <div class="row">
                        <div class="col-sm-12">
                            <label class="col-sm-3">Nama Satker</label>
                            <label>:</label>
                            <label><p id="textNamaSatkerDaerah"></p></label>
                        </div>
                    </div>
                </div>
                <div class="modal-body">
                    <h5 class="modal-title" id="exampleModalLabel">Data History Evaluasi</h5>
                    <table id="historiEvaluasi" class="table table-striped table-bordered" style="width:100%; background-color:white; margin-top:10px;">
                        <thead>
                            <tr>
                                <th style="text-align:center;">No</th>
                                <th style="text-align:center;">Evaluasi</th>
                                @*<th style="text-align:center;">Create Date</th>*@
                            </tr>
                        </thead>
                        <tbody id="listHistoryEvaluasidetailpusat"></tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    @*<button type="button" id="btnSimpan" onclick="saveRenaksi()" class="btn btn-success" data-dismiss="modal">Simpan</button>*@
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Kembali</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal Detail Evaluasi Modal -->
</div>

<style>
    .redBorder {
        border: 1px solid red;
    }

    .greyBorder {
        border: 1px solid grey;
    }
</style>

@if (@OtorisasiUser.GetJenisKantorUser() == "Pusat")
{
    <input type="hidden" name="tiperkantor" id="tipekantor" value="Pusat" />
}
else
{
    <input type="hidden" name="tiperkantor" id="tipekantor" value="Kantah" />

}

<a id="back-to-top" href="#" class="btn btn-primary back-to-top" role="button" title="" data-toggle="tooltip" data-placement="left"><span class="glyphicon glyphicon-chevron-up"></span></a>

<script type="text/javascript">
    function setTwoNumberDecimal(event) {
        this.value = parseFloat(this.value).toFixed(2);
    }

    //function minmax(ini) {
    //    var pgminpagu = $('#PGMINPAGU').val();
    //    var pgmaxpagu = $('#PGMAXPAGU').val();
    //    var jml = '';

    //    if (pgmaxpagu < pgminpagu) {
    //        $('#PGMAXPAGU').val(jml);

    //    }

    //}

    $(document).ready(function () {
        $('#CariKodeSatker').select2({
            placeholder: "Pilih Satker"
        });
        @*if (@tipekantorid != "1") {
            $('#DivSearch_Wilayah').addClass('hidden');
            $('#Th_Wilayah').addClass('hidden');
            //Th_Hapus
        }
        if (@tipekantorid == "1") {
            $('#Th_Hapus').addClass('hidden');
            $('#Th_Entri').addClass('hidden');
            $('#btnCreate').addClass('hidden');
        }*@

        createPagingPengajuan();

        $(window).scroll(function () {
            if ($(this).scrollTop() > 50) {
                $('#back-to-top').fadeIn();
            } else {
                $('#back-to-top').fadeOut();
            }
        });
        // scroll body to 0px on click
        $('#back-to-top').click(function () {
            $('#back-to-top').tooltip('hide');
            $('body,html').animate({
                scrollTop: 0
            }, 800);
            return false;
        });

        $('#back-to-top').tooltip('show');
    });

    $("#btnCreate").click(function (e) {
        window.location.href = '@Url.Action("EntriPengajuan", "Pengembalian")';

        e.preventDefault();
        return false;
    });

    $("#frmCariPengajuan").submit(function (e) {
        //$('#PGMINPAGU').val(($('#PGMINPAGU1').val()));
        dtablePengajuan.ajax.reload(null, true);
        e.preventDefault();
        return false;
    });

    //$("#btnCari").on("click", function (e) {
    //    formToPost = $('#frmCariPengajuan');
    //    $.blockUI({ message: '<div style=\"padding:10px\"><b>Sedang proses... </b><p>harap tunggu</p></div>' });
    //    e.preventDefault();
    //    return false;
    //});

    if ($('#tipekantor').val() == 'Pusat') {
        var dtablePengajuan;
        var createPagingPengajuan = function () {
            dtablePengajuan = $('#rincianAlokasi').DataTable({
                "bLengthChange": true,
                "paging": true,
                "pageLength": 10,
                "bFilter": true,
                "ordering": true,
                "info": false,
                "processing": true,
                "serverSide": false,
                "scrollX": false,
                "ajax": {
                    url: '@Url.Action("ListPenerimaan", "MonitoringEvaluasi")',
                    type: "POST",
                    data: function (data, obj) { var ftp = $('#frmCariPengajuan').serializeArray(); data.form = ftp; ftp.push({ name: "start", value: data.start }, { name: "length", value: data.length }); return ftp; }
                    //data: function (data, obj) { var ftp = $('#PGMINPAGU').val(); data.form = ftp; ftp.push({ name: "start", value: data.start }, { name: "length", value: data.length }); return ftp; }
                },

                "columns": [
                    { "data": "RNumber", "className": "centertaligncolumn", "width": "5%" },
                    { "data": 'KodeSatker' },
                    { "data": 'NamaKantor' },
                    { "data": "NilaiTarget", "className": "rightaligncolumn", render: formatangka },
                    { "data": "Penerimaan", "className": "rightaligncolumn", render: formatangka },
                    //{ "data": "REALISASIBELANJA", "className": "rightaligncolumn", render: formatangka },
                    { "data": "Persen" },
                    //{ "data": "Evaluasi" },
                    //kolom renaksi
                     {
                         "data": "Renaksi",
                         "className": "centertaligncolumn",
                         "width": "5%",
                         render: function (datum, type, row) {
                             if (row.Renaksi > 0) {
                                 //return '<p>OK</p>';
                                 //return '<span><i class="fa fa-check" style="color:#1ABC9C"></i></span>';
                                 return '<a data-toggle="tooltip" data-placement="top" title="Detail Renaksi" data-id="' + row.KantorId + '" data-renaksi="' + row.Renaksi + '"  data-kode-satker="' + row.KodeSatker + '" data-nama-kantor="' + row.NamaKantor + '" onclick="detailRenaksiPusat(this)"><span><i class="fa fa-info-circle" style="cursor: pointer;font-size:18px"></i></span>' + ((row.readrenaksi > 0) ? '<sup id="rd_' + row.KodeSatker + '" class="badge bg-danger" style="background-color:#d9534f;"><small>New</small></sup>' : '') + '</a>';
                             } else {
                                 return '<p>-</p>';
                             }

                         }
                     },

                    {
                        "data": "data",
                        "className": "centertaligncolumn",
                        "width": "5%",
                        render: function (datum, type, row) {
                            if (row.Evaluasi > 0) {
                                //return '<p>OK</p>';
                                //return '<span><i class="fa fa-check" style="color:#1ABC9C"></i></span>';
                                return '<a data-toggle="tooltip" data-placement="top" title="Detail Evaluasi" data-id="' + row.KantorId + '" data-kode-satker="' + row.KodeSatker + '" data-nama-kantor="' + row.NamaKantor + '" data-evaluasi="' + row.Evaluasi + '" onclick="detailEvaluasipusat(this)"><span><i class="fa fa-info-circle" style="cursor: pointer; font-size:18px"></i></span></a> &nbsp;<a class="btn btn-sm btn-primary" data-id="' + row.KantorId + '" data-kode-satker="' + row.KodeSatker + '" data-nama-kantor="' + row.NamaKantor + '" onclick="addEvaluasi(this)" data-toggle="tooltip" data-placement="top" title="Tambah Evaluasi"><span class="glyphicon glyphicon-plus" style="height:12px"></span></a>';
                            } else {
                                return '<a class="btn btn-sm btn-primary" data-id="' + row.KantorId + '" data-kode-satker="' + row.KodeSatker + '" data-nama-kantor="' + row.NamaKantor + '" onclick="addEvaluasi(this)" data-toggle="tooltip" data-placement="top" title="Tambah Evaluasi"><span class="glyphicon glyphicon-plus" style="height:12px"></span></a>';

                            }

                        }
                    },
                ],
                });
        };
    } else {
        var dtablePengajuan;
        var createPagingPengajuan = function () {
            dtablePengajuan = $('#rincianAlokasi').DataTable({
                "fnDrawCallback": function(oSettings) {
                    if ($('#rincianAlokasi tr').length < 5) {
                        $('.dataTables_paginate').hide();
                    }
                },
                "bLengthChange": false,
                "paging": true,
                "pageLength": 10,
                "bFilter": false,
                "ordering": true,
                "info": false,
                "processing": true,
                "serverSide": true,
                "scrollX": false,

                "ajax": {
                    url: '@Url.Action("ListPenerimaan", "MonitoringEvaluasi")',
                    type: "POST",
                    data: function (data, obj) { var ftp = $('#frmCariPengajuan').serializeArray(); data.form = ftp; ftp.push({ name: "start", value: data.start }, { name: "length", value: data.length }); return ftp; }
                },

                "columns": [
                    //{ "data": "RNumber", "className": "centertaligncolumn", "width": "5%" },
                    { "data": 'KodeSatker' },
                    { "data": 'NamaKantor' },
                    { "data": "NilaiTarget", "className": "rightaligncolumn", render: formatangka },
                    { "data": "Penerimaan", "className": "rightaligncolumn", render: formatangka },
                    //{ "data": "REALISASIBELANJA", "className": "rightaligncolumn", render: formatangka },
                    { "data": "Persen" },
                    //{ "data": "Evaluasi" },
                    {
                        "data": "Evaluasi",
                        "className": "centertaligncolumn",
                        "width": "5%",
                        render: function (datum, type, row) {
                            if (row.Evaluasi > 0) {
                                //return '<p>OK</p>';
                                //return '<span><i class="fa fa-check" style="color:#1ABC9C"></i></span>';
                                return '<a data-toggle="tooltip" data-placement="top" title="Detail Evaluasi" data-id="' + row.KantorId + '" data-kode-satker="' + row.KodeSatker + '" data-nama-kantor="' + row.NamaKantor + '" data-evaluasi="' + row.Evaluasi + '" onclick="detailEvaluasi(this)"><span><i class="fa fa-info-circle" style="cursor: pointer;font-size:18px"></i>' + ((row.readevaluasi > 0) ? '<sup id="ed_' + row.KodeSatker + '" class="badge bg-danger" style="background-color:#d9534f;"><small>New</small></sup>' : '') + '</span></a>';
                            } else {
                                return '<p>-</p>';
                            }

                        }
                    },
                    //{ "data": "Renaksi" },

                    //{
                    //    "data": "data",
                    //    "className": "centertaligncolumn",
                    //    "width": "5%",
                    //    render: function (datum, type, row) {
                    //        if (row.Evaluasi != null) {
                    //            //return '<p>OK</p>';
                    //            return '<span><i class="fa fa-check" style="color:#1ABC9C"></i></span>';
                    //        } else {
                    //            return '<a class="btn btn-sm btn-primary" data-id="' + row.kantorid + '" data-kode-satker="' + row.KodeSatker + '" data-nama-kantor="' + row.NamaKantor + '" onclick="addEvaluasi(this)"><span class="glyphicon glyphicon-plus" style="height:12px"></span></a>';

                    //        }

                    //    }
                    //},

                    {
                        "data": "data",
                        "className": "centertaligncolumn",
                        "width": "5%",
                        render: function (datum, type, row) {
                            if (row.Renaksi > 0) {
                                //return '<p>OK</p>';
                                //return '<span><i class="fa fa-check" style="color:#1ABC9C"></i></span>';
                                return '<a data-toggle="tooltip" data-placement="top" title="Detail Renaksi" data-id="' + row.KantorId + '" data-kode-satker="' + row.KodeSatker + '" data-nama-kantor="' + row.NamaKantor + '" data-renaksi="' + row.Renaksi + '" onclick="detailRenaksi(this)"><span><i class="fa fa-info-circle" style="cursor: pointer; font-size:18px"></i></span></a>&nbsp;<a class="btn btn-sm btn-primary" data-toggle="tooltip" data-placement="top" title="Aksi Renaksi" data-id="' + row.kantorid + '" data-kode-satker="' + row.KodeSatker + '" data-nama-kantor="' + row.NamaKantor + '" onclick="addRenaksi(this)"><span class="glyphicon glyphicon-plus" style="height:12px"></span></a>';
                            } else {
                                return '<a class="btn btn-sm btn-primary" data-toggle="tooltip" data-placement="top" title="Aksi Renaksi" data-id="' + row.kantorid + '" data-kode-satker="' + row.KodeSatker + '" data-nama-kantor="' + row.NamaKantor + '" onclick="addRenaksi(this)"><span class="glyphicon glyphicon-plus" style="height:12px"></span></a>';
                            }

                        }
                    },
                ],

                });
        };
    }

    //detail evaluasi akun Nasional
    function detail(ini) {
        var kantorid = $(ini).attr('data-id');
        var kodesatker = $(ini).attr('data-kode-satker');
        var namakantor = $(ini).attr('data-nama-kantor');
        var textmodal = $(ini).attr('data-evaluasi');
        //console.log(textmodal);

        $('#kantorids').val(kantorid);
        $('#textmodal').html(textmodal);
        $('#textDetailEvaluasiKode').html(kodesatker);
        $('#textDetailEvaluasiNama').html(namakantor);

        $('#detailmodal').modal('show');
    }

    //detail renaksi akun Nasional
    function detailRenaksiPusat(ini) {
        $('#listHistoryRenaksidetailpusat').html("");
        var kantorid = $(ini).attr('data-id');
        var kodesatker = $(ini).attr('data-kode-satker');
        var namakantor = $(ini).attr('data-nama-kantor');
        var textmodalRenaksi = $(ini).attr('data-renaksi');
        //console.log(textmodal);
        $('#rd_' + kodesatker).remove();
        $('#kantorids').val(kantorid);
        $('#textmodalRenaksi').html(textmodalRenaksi);
        $('#textDetailRenaksiKode').html(kodesatker);
        $('#textDetailRenaksiNama').html(namakantor);
        //Ajax Get data History Penerimaan
        $.ajax({
            type: 'POST',
            url: '@Url.Action("HistoryRenaksiPenerimaan", "MonitoringEvaluasi")',
            data: { kodesatker: kodesatker },
            success: function (data) {
                var historykode = data.result;
                //console.log(historykode);

                var list_history = '';
                for (var i = 0; i < historykode.length; i++) {
                    if (historykode[i].renaksi != null) {
                        list_history += '<tr>';
                        list_history += '<td class="addno text-center">' + (i + 1) + '</td>';
                        list_history += '<td>' + historykode[i].renaksi + ((historykode[i].read != 1) ? '<sup class="badge bg-danger" style="background-color:#d9534f;"><small>New</small></sup>' : '') + '</td>';
                        //list_history += '<td>' + (i + 1) + '</td>';
                        list_history += '</tr>';
                    }
                }

                $('#listHistoryRenaksidetailpusat').html("");
                $('#listHistoryRenaksidetailpusat').html(list_history);
                //console.log(data);
                has_read_monev_penerimaan_renaksi(kodesatker);
            }
        });
        //Ajax Get data History Penerimaan
        $('#detailmodalRenaksipusat').modal('show');
    }

    //detail renaksi akun daerah
    function detailRenaksi(ini) {
        var kantorid = $(ini).attr('data-id');
        var kodesatker = $(ini).attr('data-kode-satker');
        var namakantor = $(ini).attr('data-nama-kantor');
        var textmodalRenaksi = $(ini).attr('data-renaksi');
        //console.log(textmodal);

        $('#kantorids').val(kantorid);
        $('#textmodalRenaksi').html(textmodalRenaksi);
        $('#textDetailRenaksiKode').html(kodesatker);
        $('#textDetailRenaksiNama').html(namakantor);
        //Ajax Get data History Penerimaan
        $.ajax({
            type: 'POST',
            url: '@Url.Action("HistoryRenaksiPenerimaan","MonitoringEvaluasi")',
            data: { kodesatker: kodesatker },
            success: function (data) {
                var historykode = data.result;
                //console.log(historykode);

                var list_history = '';
                for (var i = 0; i < historykode.length; i++) {
                    if (historykode[i].renaksi != null) {
                        list_history += '<tr>';
                        list_history += '<td class="addno text-center">' + (i + 1) + '</td>';
                        list_history += '<td>' + historykode[i].renaksi + '</td>';
                        //list_history += '<td>' + (i + 1) + '</td>';
                        list_history += '</tr>';
                    }
                }

                $('#listHistoryRenaksidetail').html("");
                $('#listHistoryRenaksidetail').html(list_history);
                //console.log(data);
            }
        });
        //Ajax Get data History Penerimaan
        $('#detailmodalRenaksi').modal('show');
    }

    //detail evaluasi akun daerah
    function detailEvaluasi(ini) {
        $('#listHistoryEvaluasidetail').html("");
        var kantorid = $(ini).attr('data-id');
        var kodesatker = $(ini).attr('data-kode-satker');
        var namakantor = $(ini).attr('data-nama-kantor');
        var textmodalEvaluasi = $(ini).attr('data-evaluasi');
        //console.log(textmodal);
        $('#ed_' + kodesatker).remove();

        $('#kantorids').val(kantorid);
        $('#textmodalEvaluasi').html(textmodalEvaluasi);
        $('#textKodeSatkerDaerah').html(kodesatker);
        $('#textNamaSatkerDaerah').html(namakantor);

        //Ajax Get data History Penerimaan
        $.ajax({
            type: 'POST',
            url: '@Url.Action("HistoryEvaluasiPenerimaan","MonitoringEvaluasi")',
            data: { kodesatker: kodesatker },
            success: function (data) {
                $('#listHistoryEvaluasidetail').html("");
                var historykode = data.result;
                //console.log(historykode);

                var list_history = '';
                for (var i = 0; i < historykode.length; i++) {
                    if (historykode[i].evaluasi != null) {
                        list_history += '<tr>';
                        list_history += '<td class="addno text-center">' + (i + 1) + '</td>';
                        list_history += '<td>' + historykode[i].evaluasi + ((historykode[i].read!=1)?'<sup class="badge bg-danger" style="background-color:#d9534f;"><small>New</small></sup>':'') + '</td>';
                        //list_history += '<td>' + (i + 1) + '</td>';
                        list_history += '</tr>';
                    }
                }

                $('#listHistoryEvaluasidetail').html("");
                $('#listHistoryEvaluasidetail').html(list_history);
                //console.log(data);
                has_read_monev_penerimaan(kodesatker);
            }
        });
        //Ajax Get data History Penerimaan
        $('#detailmodalEvaluasi').modal('show');
    }

    //detail evaluasi akun pusat
    function detailEvaluasipusat(ini) {
        $('#listHistoryEvaluasidetail').html("");
        var kantorid = $(ini).attr('data-id');
        var kodesatker = $(ini).attr('data-kode-satker');
        var namakantor = $(ini).attr('data-nama-kantor');
        var textmodalEvaluasi = $(ini).attr('data-evaluasi');
        //console.log(textmodal);
        $('#ed_' + kodesatker).remove();

        $('#kantorids').val(kantorid);
        $('#textmodalEvaluasi').html(textmodalEvaluasi);
        $('#textKodeSatkerDaerah').html(kodesatker);
        $('#textNamaSatkerDaerah').html(namakantor);

        //Ajax Get data History Penerimaan
        $.ajax({
            type: 'POST',
            url: '@Url.Action("HistoryEvaluasiPenerimaan","MonitoringEvaluasi")',
            data: { kodesatker: kodesatker },
            success: function (data) {
                $('#listHistoryEvaluasidetail').html("");
                var historykode = data.result;
                //console.log(historykode);

                var list_history = '';
                for (var i = 0; i < historykode.length; i++) {
                    if (historykode[i].evaluasi != null) {
                        list_history += '<tr>';
                        list_history += '<td class="addno text-center">' + (i + 1) + '</td>';
                        list_history += '<td>' + historykode[i].evaluasi  + '</td>';
                        //list_history += '<td>' + (i + 1) + '</td>';
                        list_history += '</tr>';
                    }
                }

                $('#listHistoryEvaluasidetail').html("");
                $('#listHistoryEvaluasidetail').html(list_history);
                //console.log(data);
            }
        });
        //Ajax Get data History Penerimaan
        $('#detailmodalEvaluasi').modal('show');
    }

    function has_read_monev_penerimaan(kodesatker) {
        $.ajax({
            type: 'POST',
            url: '@Url.Action("DoReadMonevPenerimaan","MonitoringEvaluasi")',
            data: { kodesatker: kodesatker },
            success: function (data) {
                //console,log(data)
            }
        });
    }

    function has_read_monev_penerimaan_renaksi(kodesatker) {
        $.ajax({
            type: 'POST',
            url: '@Url.Action("DoReadMonevPenerimaanRenaksi", "MonitoringEvaluasi")',
            data: { kodesatker: kodesatker },
            success: function (data) {
                //console,log(data)
            }
        });
    }

    function addEvaluasi(ini) {
        var kantorid = $(ini).attr('data-id');
        var kodesatker = $(ini).attr('data-kode-satker');
        var namakantor = $(ini).attr('data-nama-kantor');
        console.log(kantorid);
        console.log(kodesatker);
        console.log(namakantor);
        $('#kantorid').val(kantorid);
        $('#kodesatker').val(kodesatker);
        $('#textKodeSatker').html(kodesatker);
        $('#textNamaSatker').html(namakantor);

        //Ajax Get data History Penerimaan
        $.ajax({
            type: 'POST',
            url: '@Url.Action("HistoryEvaluasiPenerimaan","MonitoringEvaluasi")',
            data: { kodesatker: kodesatker },
            success: function (data) {
                var historykode = data.result;
                //console.log(historykode);

                var list_history = '';
                for (var i = 0; i < historykode.length; i++) {
                    if (historykode[i].evaluasi != null) {
                        list_history += '<tr>';
                        list_history += '<td class="addno text-center">' + (i + 1) + '</td>';
                        list_history += '<td>' + historykode[i].evaluasi + '</td>';
                        //list_history += '<td>' + historykode[i].renaksi + '</td>';
                        //list_history += '<td>' + (i + 1) + '</td>';
                        list_history += '</tr>';
                    }
                }

                $('#listHistory').html("");
                $('#listHistory').html(list_history);
                //console.log(data);
            }
        });
        //Ajax Get data History Penerimaan
        //clear modal textarea
        $('#evaluasitext').val('');
        //clear modal textarea

        $('#addEvaluasi').modal('show');
    }

    function addRenaksi(ini) {
        var kantorid = $(ini).attr('data-id');
        var kodesatker = $(ini).attr('data-kode-satker');
        var namakantor = $(ini).attr('data-nama-kantor');
        //console.log(kantorid);
        //console.log(kodesatker);
        //console.log(namakantor);
        $('#kantorid').val(kantorid);
        $('#kodesatker').val(kodesatker);
        $('#textKodeSatkerRenaksi').html(kodesatker);
        $('#textNamaSatkerRenaksi').html(namakantor);


        //Ajax Get data History Penerimaan
        $.ajax({
            type: 'POST',
            url: '@Url.Action("HistoryRenaksiPenerimaan", "MonitoringEvaluasi")',
            data: { kodesatker: kodesatker },
            success: function (data) {
                var historykode = data.result;
                //console.log(historykode);

                var list_history = '';
                for (var i = 0; i < historykode.length; i++) {
                    if (historykode[i].renaksi != null) {
                        list_history += '<tr>';
                        list_history += '<td class="addno text-center">' + (i + 1) + '</td>';
                        list_history += '<td>' + historykode[i].renaksi + '</td>';
                        //list_history += '<td>' + (i + 1) + '</td>';
                        list_history += '</tr>';
                    }
                }

                $('#listHistoryRenaksi').html("");
                $('#listHistoryRenaksi').html(list_history);
                //console.log(data);
            }
        });
        //Ajax Get data History Penerimaan
        //clear modal textarea
        $('#renaksitext').val('');
        //clear modal textarea

        $('#addRenaksi').modal('show');
    }

    function saveEvaluasi() {
        var kantorid = $('#kantorid').val();
        var kodesatker = $('#kodesatker').val();
        var evaluasitext = $('#evaluasitext').val();

        console.log(kantorid);
        console.log(kodesatker);
        console.log(evaluasitext);

        if (evaluasitext == '') {
            $('textarea').addClass('redBorder');
            $('#validate').show();
            return false;
            //evaluasitext.css({ 'border-color': '#cc0000' });
        } else {
            $('textarea').addClass('greyBorder');
            $.ajax({
                url: '@Url.Action("CreateEvaluasiPenerimaan","MonitoringEvaluasi")',
                type: "POST",
                data: { kantorid: kantorid, kodesatker: kodesatker, evaluasitext: evaluasitext },
                success: function (data) {
                    //console.log(data);
                    //location.reload();
                    $('#rincianAlokasi').DataTable().ajax.reload();
                    swal({
                        title: "Berhasil",
                        text: "Data Berhasil Disimpan",
                        type: "success"
                    });
                    $("#addEvaluasi").modal("hide");
                },
            });
        }
    }

    function saveRenaksi() {
        var kantorid = $('#kantorid').val();
        var kodesatker = $('#kodesatker').val();
        var renaksitext = $('#renaksitext').val();
        console.log(kantorid);
        console.log(kodesatker);
        console.log(renaksitext);

        if (renaksitext == '') {
            $('textarea').addClass('redBorder');
            $('#validaterenaksi').show();
            return false;
        } else {
            $('textarea').addClass('greyBorder');
            $.ajax({
                url: '@Url.Action("CreateRenaksiPenerimaan", "MonitoringEvaluasi")',
                type: "POST",
                data: { kantorid: kantorid, kodesatker: kodesatker, renaksitext: renaksitext },
                success: function (data) {
                    console.log(data);
                    //location.reload();
                    $('#rincianAlokasi').DataTable().ajax.reload();
                    swal({
                        title: "Berhasil",
                        text: "Data Berhasil Disimpan",
                        type: "success"
                    });
                    $("#addRenaksi").modal("hide");
                },
            });
        }
    }

    $('#rincianAlokasi tbody').delegate('tr u', 'click', function (e) {
        var data = dtablePengajuan.row($(this).closest('tr')).data();

        //showinfo(data.PengembalianPnbpId);

        var pengembalianpnbpid = data.PengembalianPnbpId;
        if (pengembalianpnbpid !== null && pengembalianpnbpid !== '') {
            swal({
                title: "Konfirmasi Hapus Data",
                text: "Yakin Anda mau menghapus data pengajuan berkas no. " + data.NomorBerkas + " (" + data.NamaPemohon + ") ?",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "Ya",
                cancelButtonText: "Batal"
            },
            function (isConfirm) {
                if (isConfirm) {
                    $.blockUI({ message: '<div style=\"padding:10px\"><b>Sedang proses... </b><p>harap tunggu</p></div>' });
                    var frm = new FormData();
                    frm.append("pengembalianpnbpid", pengembalianpnbpid);
                    $.ajax({
                        url: '@Url.Action("HapusPengembalianPnbp", "Pengembalian")',
                        type: "POST",
                        data: frm,
                        cache: false,
                        contentType: false,
                        processData: false,
                        success: function (data, textStatus, jqXHR) {
                            if (data && data.Status) {
                                dtablePengajuan.ajax.reload(null, true);
                                showinfo('Data berhasil dihapus');
                            }
                            else {
                                showalert("Error", data.Pesan);
                            }
                            $.unblockUI();
                        },
                        error: function (jqXHR, textStatus, errorThrown) { showmsg("Error", errorThrown); $.unblockUI(); }
                    });
                }
            });
        }

        e.preventDefault();
        return false;
    });

    $('#btnReset').click(function (e) {
        location.reload();
    });

    function to_output() {
        window.location.replace('@Url.Action("RincianAlokasiOutput","Pemanfaatan")');
    }

    //Auto Size TextArea
    function auto_grow(element) {
        element.style.height = "100px";
        element.style.height = (element.scrollHeight) + "px";
    }

    //function number(evt) {
    //    //var charCode = (evt.which) ? evt.which : event.keyCode
    //    //if (charCode > 31 && (charCode < 48 || charCode > 57))
    //    //    return false;
    //}

    $(".PGMAXPAGU").on("keypress keyup blur", function (event) {
        $(this).val($(this).val().replace(/[^0-9\.|\,]/g, ''));
        debugger;
        if (event.which == 44) {
            return true;
        }
        if ((event.which != 46 || $(this).val().indexOf('.') != -1) && (event.which < 48 || event.which > 57)) {

            event.preventDefault();
        }
    });

    $(".PGMINPAGU").on("keypress keyup blur", function (event) {
        $(this).val($(this).val().replace(/[^0-9\.|\,]/g, ''));
        debugger;
        if (event.which == 44) {
            return true;
        }
        if ((event.which != 46 || $(this).val().indexOf('.') != -1) && (event.which < 48 || event.which > 57)) {

            event.preventDefault();
        }
    });

    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    });

    function validatetext() {
        if ($('#evaluasitext').val() != '' || $('#renaksitext').val() != '') {
            $('#validate').hide();
            $('#validaterenaksi').hide();
        } else {
            $('#validate').show();
            $('#validaterenaksi').show();
        }
    }
</script>